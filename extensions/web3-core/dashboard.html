<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Web3 Core - Management Dashboard</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary: #667eea;
        --primary-dark: #5568d3;
        --secondary: #764ba2;
        --success: #10b981;
        --warning: #f59e0b;
        --danger: #ef4444;
        --info: #3b82f6;
        --gray-50: #f9fafb;
        --gray-100: #f3f4f6;
        --gray-200: #e5e7eb;
        --gray-300: #d1d5db;
        --gray-400: #9ca3af;
        --gray-500: #6b7280;
        --gray-600: #4b5563;
        --gray-700: #374151;
        --gray-800: #1f2937;
        --gray-900: #111827;
        --border-radius: 8px;
        --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell,
          sans-serif;
        background: var(--gray-50);
        color: var(--gray-900);
        line-height: 1.6;
      }

      /* È°∂ÈÉ®ÂØºËà™Ê†è */
      .navbar {
        background: white;
        border-bottom: 1px solid var(--gray-200);
        padding: 1rem 2rem;
        box-shadow: var(--shadow-sm);
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .navbar-content {
        max-width: 1400px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .navbar-brand {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .navbar-brand h1 {
        font-size: 1.5rem;
        font-weight: 700;
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .navbar-status {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .status-badge {
        padding: 0.375rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.875rem;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .status-badge.online {
        background: #d1fae5;
        color: #065f46;
      }

      .status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: currentColor;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      /* ‰∏ªÂÆπÂô® */
      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 2rem;
      }

      /* Ê†áÁ≠æÈ°µÂØºËà™ */
      .tabs {
        background: white;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        margin-bottom: 2rem;
        overflow: hidden;
      }

      .tabs-nav {
        display: flex;
        border-bottom: 1px solid var(--gray-200);
      }

      .tab-button {
        flex: 1;
        padding: 1rem 1.5rem;
        background: transparent;
        border: none;
        color: var(--gray-600);
        font-size: 1rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .tab-button:hover {
        background: var(--gray-50);
        color: var(--gray-900);
      }

      .tab-button.active {
        color: var(--primary);
        background: var(--gray-50);
      }

      .tab-button.active::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: var(--primary);
      }

      .tab-content {
        display: none;
        padding: 2rem;
      }

      .tab-content.active {
        display: block;
      }

      /* Âç°ÁâáÊ†∑Âºè */
      .card {
        background: white;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }

      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--gray-200);
      }

      .card-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--gray-900);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      /* ÁªüËÆ°Âç°Áâá */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .stat-card {
        background: white;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        padding: 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .stat-icon {
        width: 48px;
        height: 48px;
        border-radius: var(--border-radius);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        flex-shrink: 0;
      }

      .stat-icon.primary {
        background: #ddd6fe;
        color: var(--primary);
      }

      .stat-icon.success {
        background: #d1fae5;
        color: var(--success);
      }

      .stat-icon.warning {
        background: #fef3c7;
        color: var(--warning);
      }

      .stat-icon.danger {
        background: #fee2e2;
        color: var(--danger);
      }

      .stat-content {
        flex: 1;
      }

      .stat-label {
        font-size: 0.875rem;
        color: var(--gray-600);
        margin-bottom: 0.25rem;
      }

      .stat-value {
        font-size: 1.875rem;
        font-weight: 700;
        color: var(--gray-900);
      }

      .stat-change {
        font-size: 0.75rem;
        margin-top: 0.25rem;
      }

      .stat-change.up {
        color: var(--success);
      }

      .stat-change.down {
        color: var(--danger);
      }

      /* Ë°®Ê†ºÊ†∑Âºè */
      .table-container {
        overflow-x: auto;
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }

      thead {
        background: var(--gray-50);
      }

      th {
        padding: 0.75rem 1rem;
        text-align: left;
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--gray-700);
        border-bottom: 1px solid var(--gray-200);
      }

      td {
        padding: 0.75rem 1rem;
        border-bottom: 1px solid var(--gray-200);
        font-size: 0.875rem;
      }

      tbody tr:hover {
        background: var(--gray-50);
      }

      /* ÊåâÈíÆÊ†∑Âºè */
      .button {
        padding: 0.5rem 1rem;
        border-radius: var(--border-radius);
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        border: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .button-primary {
        background: var(--primary);
        color: white;
      }

      .button-primary:hover {
        background: var(--primary-dark);
      }

      .button-success {
        background: var(--success);
        color: white;
      }

      .button-success:hover {
        background: #059669;
      }

      .button-danger {
        background: var(--danger);
        color: white;
      }

      .button-danger:hover {
        background: #dc2626;
      }

      .button-secondary {
        background: var(--gray-200);
        color: var(--gray-700);
      }

      .button-secondary:hover {
        background: var(--gray-300);
      }

      .button-sm {
        padding: 0.375rem 0.75rem;
        font-size: 0.8125rem;
      }

      /* ÂæΩÁ´†Ê†∑Âºè */
      .badge {
        padding: 0.25rem 0.625rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 500;
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
      }

      .badge-success {
        background: #d1fae5;
        color: #065f46;
      }

      .badge-warning {
        background: #fef3c7;
        color: #92400e;
      }

      .badge-danger {
        background: #fee2e2;
        color: #991b1b;
      }

      .badge-info {
        background: #dbeafe;
        color: #1e40af;
      }

      .badge-gray {
        background: var(--gray-200);
        color: var(--gray-700);
      }

      /* Â∑•ÂÖ∑Ê†è */
      .toolbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        flex-wrap: wrap;
        gap: 1rem;
      }

      .search-box {
        display: flex;
        align-items: center;
        background: white;
        border: 1px solid var(--gray-300);
        border-radius: var(--border-radius);
        padding: 0.5rem 1rem;
        min-width: 300px;
      }

      .search-box input {
        border: none;
        outline: none;
        flex: 1;
        font-size: 0.875rem;
      }

      .filter-group {
        display: flex;
        gap: 0.5rem;
      }

      select {
        padding: 0.5rem 1rem;
        border: 1px solid var(--gray-300);
        border-radius: var(--border-radius);
        font-size: 0.875rem;
        background: white;
        cursor: pointer;
      }

      /* Á©∫Áä∂ÊÄÅ */
      .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        color: var(--gray-500);
      }

      .empty-state-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
        opacity: 0.5;
      }

      /* ÂëäË≠¶Ê†∑Âºè */
      .alert {
        padding: 1rem;
        border-radius: var(--border-radius);
        margin-bottom: 1rem;
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
      }

      .alert-icon {
        font-size: 1.25rem;
      }

      .alert-content {
        flex: 1;
      }

      .alert-title {
        font-weight: 600;
        margin-bottom: 0.25rem;
      }

      .alert-message {
        font-size: 0.875rem;
        opacity: 0.9;
      }

      .alert-p0 {
        background: #fee2e2;
        color: #991b1b;
        border-left: 4px solid var(--danger);
      }

      .alert-p1 {
        background: #fef3c7;
        color: #92400e;
        border-left: 4px solid var(--warning);
      }

      .alert-p2 {
        background: #dbeafe;
        color: #1e40af;
        border-left: 4px solid var(--info);
      }

      /* ËøõÂ∫¶Êù° */
      .progress {
        height: 8px;
        background: var(--gray-200);
        border-radius: 9999px;
        overflow: hidden;
        margin-top: 0.5rem;
      }

      .progress-bar {
        height: 100%;
        background: var(--primary);
        transition: width 0.3s;
      }

      /* ÂìçÂ∫îÂºè */
      @media (max-width: 768px) {
        .navbar {
          padding: 1rem;
        }

        .container {
          padding: 1rem;
        }

        .tabs-nav {
          overflow-x: auto;
        }

        .tab-button {
          flex: none;
          white-space: nowrap;
        }

        .stats-grid {
          grid-template-columns: 1fr;
        }

        .toolbar {
          flex-direction: column;
          align-items: stretch;
        }

        .search-box {
          min-width: auto;
        }
      }

      /* Âä†ËΩΩÂä®Áîª */
      .loading {
        text-align: center;
        padding: 3rem;
        color: var(--gray-500);
      }

      .spinner {
        border: 3px solid var(--gray-200);
        border-top-color: var(--primary);
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 0.8s linear infinite;
        margin: 0 auto 1rem;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Êìç‰ΩúÊåâÈíÆÁªÑ */
      .action-buttons {
        display: flex;
        gap: 0.5rem;
      }

      /* Êó∂Èó¥ËΩ¥ */
      .timeline {
        position: relative;
        padding-left: 2rem;
      }

      .timeline::before {
        content: "";
        position: absolute;
        left: 0.5rem;
        top: 0;
        bottom: 0;
        width: 2px;
        background: var(--gray-200);
      }

      .timeline-item {
        position: relative;
        padding-bottom: 1.5rem;
      }

      .timeline-item::before {
        content: "";
        position: absolute;
        left: -1.625rem;
        top: 0.25rem;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: var(--primary);
        border: 2px solid white;
        box-shadow: 0 0 0 2px var(--primary);
      }

      .timeline-time {
        font-size: 0.75rem;
        color: var(--gray-500);
        margin-bottom: 0.25rem;
      }

      .timeline-content {
        background: var(--gray-50);
        padding: 0.75rem;
        border-radius: var(--border-radius);
      }

      .timeline-title {
        font-weight: 600;
        margin-bottom: 0.25rem;
      }

      /* Chart placeholder */
      .chart-placeholder {
        background: var(--gray-100);
        border: 2px dashed var(--gray-300);
        border-radius: var(--border-radius);
        padding: 3rem;
        text-align: center;
        color: var(--gray-500);
        font-size: 0.875rem;
      }
    </style>
  </head>
  <body>
    <!-- È°∂ÈÉ®ÂØºËà™Ê†è -->
    <nav class="navbar">
      <div class="navbar-content">
        <div class="navbar-brand">
          <span style="font-size: 2rem">üåê</span>
          <h1>Web3 Core Dashboard</h1>
        </div>
        <div class="navbar-status">
          <div class="status-badge online">
            <span class="status-dot"></span>
            <span>System Online</span>
          </div>
          <button class="button button-secondary button-sm" onclick="refreshAll()">
            üîÑ Refresh
          </button>
        </div>
      </div>
    </nav>

    <!-- ‰∏ªÂÆπÂô® -->
    <div class="container">
      <!-- Ê†áÁ≠æÈ°µ -->
      <div class="tabs">
        <div class="tabs-nav">
          <button class="tab-button active" data-tab="overview" onclick="switchTab('overview')">
            üìä Overview
          </button>
          <button class="tab-button" data-tab="resources" onclick="switchTab('resources')">
            üéØ Resources
          </button>
          <button class="tab-button" data-tab="disputes" onclick="switchTab('disputes')">
            ‚öñÔ∏è Disputes
          </button>
          <button class="tab-button" data-tab="alerts" onclick="switchTab('alerts')">
            üö® Alerts
          </button>
        </div>

        <!-- Overview Tab -->
        <div class="tab-content active" id="tab-overview">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon primary">üéØ</div>
              <div class="stat-content">
                <div class="stat-label">Total Resources</div>
                <div class="stat-value" id="stat-total-resources">0</div>
                <div class="stat-change up">‚Üó +12 this week</div>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon success">‚úÖ</div>
              <div class="stat-content">
                <div class="stat-label">Active Leases</div>
                <div class="stat-value" id="stat-active-leases">0</div>
                <div class="stat-change up">‚Üó +5 this week</div>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon warning">‚öñÔ∏è</div>
              <div class="stat-content">
                <div class="stat-label">Open Disputes</div>
                <div class="stat-value" id="stat-open-disputes">0</div>
                <div class="stat-change down">‚Üò -2 this week</div>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon danger">üö®</div>
              <div class="stat-content">
                <div class="stat-label">Active Alerts</div>
                <div class="stat-value" id="stat-active-alerts">0</div>
                <div class="stat-change">‚Üí No change</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3 class="card-title">üìà System Metrics</h3>
            </div>
            <div class="chart-placeholder">
              üìä Chart visualization will be rendered here<br />
              (Resource usage, dispute trends, alert history)
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3 class="card-title">‚è±Ô∏è Recent Activity</h3>
            </div>
            <div class="timeline" id="recent-activity">
              <div class="timeline-item">
                <div class="timeline-time">2 minutes ago</div>
                <div class="timeline-content">
                  <div class="timeline-title">New Resource Listed</div>
                  <div>Resource #1234 was listed by provider 0xABC...DEF</div>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-time">15 minutes ago</div>
                <div class="timeline-content">
                  <div class="timeline-title">Dispute Resolved</div>
                  <div>Dispute #56 was resolved in favor of consumer</div>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-time">1 hour ago</div>
                <div class="timeline-content">
                  <div class="timeline-title">Alert Cleared</div>
                  <div>P1 Alert: High dispute rate has been cleared</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Resources Tab -->
        <div class="tab-content" id="tab-resources">
          <div class="toolbar">
            <div class="search-box">
              <span>üîç</span>
              <input
                type="text"
                placeholder="Search resources..."
                id="search-resources"
                oninput="filterResources()"
              />
            </div>
            <div class="filter-group">
              <select id="filter-resource-status" onchange="filterResources()">
                <option value="">All Status</option>
                <option value="available">Available</option>
                <option value="leased">Leased</option>
                <option value="maintenance">Maintenance</option>
              </select>
              <button class="button button-primary" onclick="createResource()">
                ‚ûï List Resource
              </button>
            </div>
          </div>

          <div class="card">
            <div class="table-container">
              <table id="resources-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Provider</th>
                    <th>Price/Hour</th>
                    <th>Status</th>
                    <th>Leases</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="resources-tbody">
                  <!-- Will be populated by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Disputes Tab -->
        <div class="tab-content" id="tab-disputes">
          <div class="toolbar">
            <div class="search-box">
              <span>üîç</span>
              <input
                type="text"
                placeholder="Search disputes..."
                id="search-disputes"
                oninput="filterDisputes()"
              />
            </div>
            <div class="filter-group">
              <select id="filter-dispute-status" onchange="filterDisputes()">
                <option value="">All Status</option>
                <option value="open">Open</option>
                <option value="investigating">Investigating</option>
                <option value="resolved">Resolved</option>
              </select>
              <button class="button button-primary" onclick="createDispute()">
                ‚ûï File Dispute
              </button>
            </div>
          </div>

          <div class="card">
            <div class="table-container">
              <table id="disputes-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Lease ID</th>
                    <th>Filed By</th>
                    <th>Reason</th>
                    <th>Status</th>
                    <th>Filed At</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="disputes-tbody">
                  <!-- Will be populated by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Alerts Tab -->
        <div class="tab-content" id="tab-alerts">
          <div class="toolbar">
            <div class="filter-group">
              <select id="filter-alert-priority" onchange="filterAlerts()">
                <option value="">All Priorities</option>
                <option value="P0">P0 - Critical</option>
                <option value="P1">P1 - High</option>
                <option value="P2">P2 - Medium</option>
              </select>
              <select id="filter-alert-status" onchange="filterAlerts()">
                <option value="">All Status</option>
                <option value="active">Active</option>
                <option value="acknowledged">Acknowledged</option>
                <option value="resolved">Resolved</option>
              </select>
              <button class="button button-secondary" onclick="acknowledgeAllAlerts()">
                ‚úì Acknowledge All
              </button>
            </div>
          </div>

          <div id="alerts-container">
            <!-- Will be populated by JavaScript -->
          </div>

          <div class="card">
            <div class="card-header">
              <h3 class="card-title">üìä Alert Statistics</h3>
            </div>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-icon danger">üî¥</div>
                <div class="stat-content">
                  <div class="stat-label">P0 Alerts</div>
                  <div class="stat-value" id="stat-p0-alerts">0</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon warning">üü°</div>
                <div class="stat-content">
                  <div class="stat-label">P1 Alerts</div>
                  <div class="stat-value" id="stat-p1-alerts">0</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon info">üîµ</div>
                <div class="stat-content">
                  <div class="stat-label">P2 Alerts</div>
                  <div class="stat-value" id="stat-p2-alerts">0</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Load API Client -->
    <script src="dashboard-api.js"></script>

    <script>
      // Mock data (fallback for offline mode)
      let mockData = {
        resources: [
          {
            id: "R001",
            name: "GPT-4 API Endpoint",
            provider: "0xABC...DEF",
            pricePerHour: 5.0,
            status: "available",
            leases: 3,
          },
          {
            id: "R002",
            name: "Claude-3 Sonnet",
            provider: "0x123...456",
            pricePerHour: 4.5,
            status: "leased",
            leases: 1,
          },
          {
            id: "R003",
            name: "Llama-3 70B",
            provider: "0x789...ABC",
            pricePerHour: 3.0,
            status: "available",
            leases: 5,
          },
        ],
        disputes: [
          {
            id: "D001",
            leaseId: "L123",
            filedBy: "0xConsumer1",
            reason: "Service downtime",
            status: "investigating",
            filedAt: "2026-02-21 10:30",
          },
          {
            id: "D002",
            leaseId: "L456",
            filedBy: "0xConsumer2",
            reason: "Quality issues",
            status: "open",
            filedAt: "2026-02-21 14:15",
          },
        ],
        alerts: [
          {
            id: "A001",
            priority: "P0",
            category: "system",
            title: "High Error Rate",
            message: "Error rate exceeded 10% threshold",
            status: "active",
            timestamp: "2026-02-21 15:45",
          },
          {
            id: "A002",
            priority: "P1",
            category: "dispute",
            title: "Dispute Volume High",
            message: "15 open disputes detected",
            status: "active",
            timestamp: "2026-02-21 14:30",
          },
        ],
      };

      // Tab switching
      function switchTab(tabName) {
        // Update tab buttons
        document.querySelectorAll(".tab-button").forEach((btn) => {
          btn.classList.remove("active");
        });
        document.querySelector(`[data-tab="${tabName}"]`).classList.add("active");

        // Update tab content
        document.querySelectorAll(".tab-content").forEach((content) => {
          content.classList.remove("active");
        });
        document.getElementById(`tab-${tabName}`).classList.add("active");

        // Load data for the tab
        loadTabData(tabName);
      }

      function loadTabData(tabName) {
        switch (tabName) {
          case "overview":
            updateOverviewStats();
            break;
          case "resources":
            renderResourcesTable();
            break;
          case "disputes":
            renderDisputesTable();
            break;
          case "alerts":
            renderAlerts();
            break;
        }
      }

      // Update overview statistics
      function updateOverviewStats() {
        document.getElementById("stat-total-resources").textContent = mockData.resources.length;
        document.getElementById("stat-active-leases").textContent = mockData.resources.reduce(
          (sum, r) => sum + r.leases,
          0
        );
        document.getElementById("stat-open-disputes").textContent = mockData.disputes.filter(
          (d) => d.status !== "resolved"
        ).length;
        document.getElementById("stat-active-alerts").textContent = mockData.alerts.filter(
          (a) => a.status === "active"
        ).length;
      }

      // Render resources table
      function renderResourcesTable() {
        const tbody = document.getElementById("resources-tbody");
        tbody.innerHTML = "";

        mockData.resources.forEach((resource) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td><strong>${resource.id}</strong></td>
            <td>${resource.name}</td>
            <td><code style="font-size: 0.75rem">${resource.provider}</code></td>
            <td>$${resource.pricePerHour.toFixed(2)}</td>
            <td>
              <span class="badge badge-${resource.status === "available" ? "success" : resource.status === "leased" ? "info" : "warning"}">
                ${resource.status}
              </span>
            </td>
            <td>${resource.leases}</td>
            <td>
              <div class="action-buttons">
                <button class="button button-sm button-secondary" onclick="viewResource('${resource.id}')">View</button>
                <button class="button button-sm button-primary" onclick="editResource('${resource.id}')">Edit</button>
              </div>
            </td>
          `;
          tbody.appendChild(row);
        });
      }

      // Render disputes table
      function renderDisputesTable() {
        const tbody = document.getElementById("disputes-tbody");
        tbody.innerHTML = "";

        mockData.disputes.forEach((dispute) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td><strong>${dispute.id}</strong></td>
            <td>${dispute.leaseId}</td>
            <td><code style="font-size: 0.75rem">${dispute.filedBy}</code></td>
            <td>${dispute.reason}</td>
            <td>
              <span class="badge badge-${dispute.status === "resolved" ? "success" : dispute.status === "investigating" ? "warning" : "danger"}">
                ${dispute.status}
              </span>
            </td>
            <td>${dispute.filedAt}</td>
            <td>
              <div class="action-buttons">
                <button class="button button-sm button-secondary" onclick="viewDispute('${dispute.id}')">View</button>
                ${dispute.status !== "resolved" ? `<button class="button button-sm button-success" onclick="resolveDispute('${dispute.id}')">Resolve</button>` : ""}
              </div>
            </td>
          `;
          tbody.appendChild(row);
        });
      }

      // Render alerts
      function renderAlerts() {
        const container = document.getElementById("alerts-container");
        container.innerHTML = "";

        if (mockData.alerts.length === 0) {
          container.innerHTML = `
            <div class="empty-state">
              <div class="empty-state-icon">‚úÖ</div>
              <div style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem">No Active Alerts</div>
              <div>All systems are running smoothly</div>
            </div>
          `;
          return;
        }

        mockData.alerts.forEach((alert) => {
          const alertDiv = document.createElement("div");
          alertDiv.className = `alert alert-${alert.priority.toLowerCase()}`;
          alertDiv.innerHTML = `
            <div class="alert-icon">${alert.priority === "P0" ? "üî¥" : alert.priority === "P1" ? "üü°" : "üîµ"}</div>
            <div class="alert-content">
              <div class="alert-title">[${alert.priority}] ${alert.title}</div>
              <div class="alert-message">${alert.message}</div>
              <div style="font-size: 0.75rem; color: inherit; opacity: 0.7; margin-top: 0.5rem">
                ${alert.timestamp}
              </div>
            </div>
            <div class="action-buttons" style="flex-direction: column">
              ${alert.status === "active" ? `<button class="button button-sm button-secondary" onclick="acknowledgeAlert('${alert.id}')">Acknowledge</button>` : ""}
              <button class="button button-sm button-success" onclick="resolveAlert('${alert.id}')">Resolve</button>
            </div>
          `;
          container.appendChild(alertDiv);
        });

        // Update alert statistics
        document.getElementById("stat-p0-alerts").textContent = mockData.alerts.filter(
          (a) => a.priority === "P0" && a.status === "active"
        ).length;
        document.getElementById("stat-p1-alerts").textContent = mockData.alerts.filter(
          (a) => a.priority === "P1" && a.status === "active"
        ).length;
        document.getElementById("stat-p2-alerts").textContent = mockData.alerts.filter(
          (a) => a.priority === "P2" && a.status === "active"
        ).length;
      }

      // Filter functions
      function filterResources() {
        const search = document.getElementById("search-resources").value.toLowerCase();
        const status = document.getElementById("filter-resource-status").value;

        const filtered = mockData.resources.filter((resource) => {
          const matchesSearch =
            resource.name.toLowerCase().includes(search) ||
            resource.provider.toLowerCase().includes(search);
          const matchesStatus = !status || resource.status === status;
          return matchesSearch && matchesStatus;
        });

        // Re-render with filtered data
        const tbody = document.getElementById("resources-tbody");
        tbody.innerHTML = "";
        filtered.forEach((resource) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td><strong>${resource.id}</strong></td>
            <td>${resource.name}</td>
            <td><code style="font-size: 0.75rem">${resource.provider}</code></td>
            <td>$${resource.pricePerHour.toFixed(2)}</td>
            <td>
              <span class="badge badge-${resource.status === "available" ? "success" : resource.status === "leased" ? "info" : "warning"}">
                ${resource.status}
              </span>
            </td>
            <td>${resource.leases}</td>
            <td>
              <div class="action-buttons">
                <button class="button button-sm button-secondary" onclick="viewResource('${resource.id}')">View</button>
                <button class="button button-sm button-primary" onclick="editResource('${resource.id}')">Edit</button>
              </div>
            </td>
          `;
          tbody.appendChild(row);
        });
      }

      function filterDisputes() {
        const search = document.getElementById("search-disputes").value.toLowerCase();
        const status = document.getElementById("filter-dispute-status").value;

        const filtered = mockData.disputes.filter((dispute) => {
          const matchesSearch =
            dispute.id.toLowerCase().includes(search) ||
            dispute.leaseId.toLowerCase().includes(search) ||
            dispute.reason.toLowerCase().includes(search);
          const matchesStatus = !status || dispute.status === status;
          return matchesSearch && matchesStatus;
        });

        const tbody = document.getElementById("disputes-tbody");
        tbody.innerHTML = "";
        filtered.forEach((dispute) => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td><strong>${dispute.id}</strong></td>
            <td>${dispute.leaseId}</td>
            <td><code style="font-size: 0.75rem">${dispute.filedBy}</code></td>
            <td>${dispute.reason}</td>
            <td>
              <span class="badge badge-${dispute.status === "resolved" ? "success" : dispute.status === "investigating" ? "warning" : "danger"}">
                ${dispute.status}
              </span>
            </td>
            <td>${dispute.filedAt}</td>
            <td>
              <div class="action-buttons">
                <button class="button button-sm button-secondary" onclick="viewDispute('${dispute.id}')">View</button>
                ${dispute.status !== "resolved" ? `<button class="button button-sm button-success" onclick="resolveDispute('${dispute.id}')">Resolve</button>` : ""}
              </div>
            </td>
          `;
          tbody.appendChild(row);
        });
      }

      function filterAlerts() {
        const priority = document.getElementById("filter-alert-priority").value;
        const status = document.getElementById("filter-alert-status").value;

        const filtered = mockData.alerts.filter((alert) => {
          const matchesPriority = !priority || alert.priority === priority;
          const matchesStatus = !status || alert.status === status;
          return matchesPriority && matchesStatus;
        });

        const container = document.getElementById("alerts-container");
        container.innerHTML = "";

        filtered.forEach((alert) => {
          const alertDiv = document.createElement("div");
          alertDiv.className = `alert alert-${alert.priority.toLowerCase()}`;
          alertDiv.innerHTML = `
            <div class="alert-icon">${alert.priority === "P0" ? "üî¥" : alert.priority === "P1" ? "üü°" : "üîµ"}</div>
            <div class="alert-content">
              <div class="alert-title">[${alert.priority}] ${alert.title}</div>
              <div class="alert-message">${alert.message}</div>
              <div style="font-size: 0.75rem; color: inherit; opacity: 0.7; margin-top: 0.5rem">
                ${alert.timestamp}
              </div>
            </div>
            <div class="action-buttons" style="flex-direction: column">
              ${alert.status === "active" ? `<button class="button button-sm button-secondary" onclick="acknowledgeAlert('${alert.id}')">Acknowledge</button>` : ""}
              <button class="button button-sm button-success" onclick="resolveAlert('${alert.id}')">Resolve</button>
            </div>
          `;
          container.appendChild(alertDiv);
        });
      }

      // Action handlers
      function refreshAll() {
        console.log("Refreshing all data...");
        location.reload();
      }

      function createResource() {
        alert("üìù Create Resource Modal would open here");
      }

      function viewResource(id) {
        console.log("Viewing resource:", id);
        alert(`üìÑ View details for resource ${id}`);
      }

      function editResource(id) {
        console.log("Editing resource:", id);
        alert(`‚úèÔ∏è Edit modal for resource ${id}`);
      }

      function createDispute() {
        alert("üìù File Dispute Modal would open here");
      }

      function viewDispute(id) {
        console.log("Viewing dispute:", id);
        alert(`üìÑ View details for dispute ${id}`);
      }

      function resolveDispute(id) {
        if (confirm(`Resolve dispute ${id}?`)) {
          const dispute = mockData.disputes.find((d) => d.id === id);
          if (dispute) {
            dispute.status = "resolved";
            renderDisputesTable();
            updateOverviewStats();
          }
        }
      }

      function acknowledgeAlert(id) {
        const alert = mockData.alerts.find((a) => a.id === id);
        if (alert) {
          alert.status = "acknowledged";
          renderAlerts();
          updateOverviewStats();
        }
      }

      function resolveAlert(id) {
        if (confirm(`Resolve alert ${id}?`)) {
          mockData.alerts = mockData.alerts.filter((a) => a.id !== id);
          renderAlerts();
          updateOverviewStats();
        }
      }

      function acknowledgeAllAlerts() {
        if (confirm("Acknowledge all active alerts?")) {
          mockData.alerts.forEach((alert) => {
            if (alert.status === "active") {
              alert.status = "acknowledged";
            }
          });
          renderAlerts();
        }
      }

      // Initialize on page load
      window.onload = async function () {
        console.log("üöÄ Dashboard loading...");

        // Check if we can connect to real API
        try {
          await dashboard.api.healthCheck();
          console.log("‚úÖ API connection established");

          // Load real data
          await dashboard.initialize();

          // Enable auto-refresh every 30 seconds
          // dashboard.enableAutoRefresh(30000);
        } catch (error) {
          console.warn("‚ö†Ô∏è API not available, using mock data", error);

          // Fallback to mock data
          updateOverviewStats();
          renderResourcesTable();
          renderDisputesTable();
          renderAlerts();
        }

        console.log("‚úÖ Dashboard ready");
      };
    </script>
  </body>
</html>
