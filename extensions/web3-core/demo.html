<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Web3 Core Plugin - Interactive Demo</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell,
          sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      .header {
        text-align: center;
        color: white;
        margin-bottom: 40px;
      }

      .header h1 {
        font-size: 3em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .header p {
        font-size: 1.2em;
        opacity: 0.9;
      }

      .demo-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .card {
        background: white;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        transition:
          transform 0.3s,
          box-shadow 0.3s;
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      }

      .card h2 {
        color: #667eea;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .icon {
        font-size: 1.5em;
      }

      .button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1em;
        font-weight: 600;
        transition: all 0.3s;
        width: 100%;
        margin-top: 10px;
      }

      .button:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      .button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .output {
        background: #f7f9fc;
        border: 1px solid #e1e8ed;
        border-radius: 8px;
        padding: 15px;
        margin-top: 15px;
        font-family: "Courier New", monospace;
        font-size: 0.9em;
        max-height: 300px;
        overflow-y: auto;
        white-space: pre-wrap;
        word-wrap: break-word;
      }

      .status {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 0.85em;
        font-weight: 600;
        margin-left: 10px;
      }

      .status.loaded {
        background: #d4edda;
        color: #155724;
      }

      .status.pending {
        background: #fff3cd;
        color: #856404;
      }

      .input-group {
        margin-bottom: 15px;
      }

      .input-group label {
        display: block;
        margin-bottom: 5px;
        color: #333;
        font-weight: 600;
      }

      .input-group input,
      .input-group select {
        width: 100%;
        padding: 10px;
        border: 2px solid #e1e8ed;
        border-radius: 6px;
        font-size: 1em;
        transition: border-color 0.3s;
      }

      .input-group input:focus,
      .input-group select:focus {
        outline: none;
        border-color: #667eea;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        margin-top: 15px;
      }

      .stat-item {
        background: #f7f9fc;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
      }

      .stat-value {
        font-size: 2em;
        font-weight: bold;
        color: #667eea;
      }

      .stat-label {
        font-size: 0.9em;
        color: #666;
        margin-top: 5px;
      }

      .timeline {
        margin-top: 20px;
      }

      .timeline-item {
        background: #f7f9fc;
        padding: 12px;
        border-radius: 6px;
        margin-bottom: 8px;
        border-left: 4px solid #667eea;
      }

      .timeline-time {
        font-size: 0.85em;
        color: #666;
      }

      .timeline-event {
        font-weight: 600;
        color: #333;
        margin-top: 4px;
      }

      .footer {
        text-align: center;
        color: white;
        margin-top: 40px;
        padding: 20px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 12px;
      }

      .footer a {
        color: white;
        text-decoration: none;
        font-weight: 600;
      }

      .footer a:hover {
        text-decoration: underline;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      .loading {
        animation: pulse 1.5s infinite;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>ğŸŒ Web3 Core Plugin</h1>
        <p>OpenClaw å»ä¸­å¿ƒåŒ–åŸºç¡€è®¾æ–½æ¼”ç¤º</p>
        <span class="status loaded">v2026.2.16 - Loaded</span>
      </div>

      <div class="demo-grid">
        <!-- 1. èº«ä»½è®¤è¯ -->
        <div class="card">
          <h2><span class="icon">ğŸ”</span> èº«ä»½è®¤è¯</h2>
          <p style="color: #666; margin-bottom: 15px">åŸºäº SIWE çš„ä»¥å¤ªåŠé’±åŒ…ç™»å½•</p>

          <div class="input-group">
            <label>é’±åŒ…åœ°å€</label>
            <input type="text" id="walletAddress" placeholder="0x1234...5678" />
          </div>

          <button class="button" onclick="generateChallenge()">ç”Ÿæˆ SIWE æŒ‘æˆ˜</button>

          <button class="button" onclick="bindWallet()">ç»‘å®šé’±åŒ…</button>

          <button class="button" onclick="checkIdentity()">æŸ¥çœ‹èº«ä»½</button>

          <div id="identityOutput" class="output" style="display: none"></div>
        </div>

        <!-- 2. å®¡è®¡è¿½è¸ª -->
        <div class="card">
          <h2><span class="icon">ğŸ“</span> å®¡è®¡è¿½è¸ª</h2>
          <p style="color: #666; margin-bottom: 15px">LLM äº¤äº’æ—¥å¿—ä¸é“¾ä¸Šé”šå®š</p>

          <button class="button" onclick="createAuditEvent()">åˆ›å»ºå®¡è®¡äº‹ä»¶</button>

          <button class="button" onclick="queryAuditLog()">æŸ¥è¯¢å®¡è®¡æ—¥å¿—</button>

          <button class="button" onclick="verifyIntegrity()">éªŒè¯æ•°æ®å®Œæ•´æ€§</button>

          <div id="auditOutput" class="output" style="display: none"></div>

          <div class="timeline" id="auditTimeline" style="display: none"></div>
        </div>

        <!-- 3. è®¡è´¹ä¿æŠ¤ -->
        <div class="card">
          <h2><span class="icon">ğŸ’°</span> è®¡è´¹ä¿æŠ¤</h2>
          <p style="color: #666; margin-bottom: 15px">é…é¢ç®¡ç†ä¸ä½¿ç”¨è¿½è¸ª</p>

          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-value" id="creditsUsed">0</div>
              <div class="stat-label">å·²ä½¿ç”¨é…é¢</div>
            </div>
            <div class="stat-item">
              <div class="stat-value" id="creditsRemaining">1000</div>
              <div class="stat-label">å‰©ä½™é…é¢</div>
            </div>
          </div>

          <button class="button" onclick="checkCredits()">æŸ¥çœ‹é…é¢çŠ¶æ€</button>

          <button class="button" onclick="simulateUsage()">æ¨¡æ‹Ÿä½¿ç”¨</button>

          <button class="button" onclick="checkPaymentStatus()">æŸ¥çœ‹æ”¯ä»˜çŠ¶æ€</button>

          <div id="billingOutput" class="output" style="display: none"></div>
        </div>

        <!-- 4. å»ä¸­å¿ƒåŒ–å­˜å‚¨ -->
        <div class="card">
          <h2><span class="icon">ğŸ’¾</span> å»ä¸­å¿ƒåŒ–å­˜å‚¨</h2>
          <p style="color: #666; margin-bottom: 15px">IPFS/Arweave/Filecoin å½’æ¡£</p>

          <div class="input-group">
            <label>å­˜å‚¨æä¾›å•†</label>
            <select id="storageProvider">
              <option value="ipfs">IPFS (Pinata)</option>
              <option value="arweave">Arweave</option>
              <option value="filecoin">Filecoin</option>
            </select>
          </div>

          <button class="button" onclick="uploadToStorage()">ä¸Šä¼ ç¤ºä¾‹æ•°æ®</button>

          <button class="button" onclick="retrieveFromStorage()">æ£€ç´¢æ•°æ®</button>

          <button class="button" onclick="checkStorageStatus()">å­˜å‚¨çŠ¶æ€</button>

          <div id="storageOutput" class="output" style="display: none"></div>
        </div>

        <!-- 5. é“¾ä¸Šé”šå®š -->
        <div class="card">
          <h2><span class="icon">â›“ï¸</span> é“¾ä¸Šé”šå®š</h2>
          <p style="color: #666; margin-bottom: 15px">Base/Optimism/Arbitrum æ•°æ®é”šå®š</p>

          <div class="input-group">
            <label>ç›®æ ‡é“¾</label>
            <select id="targetChain">
              <option value="base">Base</option>
              <option value="optimism">Optimism</option>
              <option value="arbitrum">Arbitrum</option>
            </select>
          </div>

          <button class="button" onclick="anchorData()">é”šå®šæ•°æ®å“ˆå¸Œ</button>

          <button class="button" onclick="verifyAnchor()">éªŒè¯é”šå®š</button>

          <button class="button" onclick="getAnchorHistory()">é”šå®šå†å²</button>

          <div id="chainOutput" class="output" style="display: none"></div>
        </div>

        <!-- 6. æ•´ä½“çŠ¶æ€ -->
        <div class="card">
          <h2><span class="icon">ğŸ“Š</span> æ•´ä½“çŠ¶æ€</h2>
          <p style="color: #666; margin-bottom: 15px">Web3 ç³»ç»ŸçŠ¶æ€æ€»è§ˆ</p>

          <button class="button" onclick="getOverallStatus()">è·å–å®Œæ•´çŠ¶æ€</button>

          <button class="button" onclick="runHealthCheck()">å¥åº·æ£€æŸ¥</button>

          <button class="button" onclick="resetDemo()">é‡ç½®æ¼”ç¤º</button>

          <div id="statusOutput" class="output" style="display: none"></div>
        </div>
      </div>

      <div class="footer">
        <p>
          ğŸ“–
          <a
            href="file:///Users/huangrenbin/Documents/UGit/openclaw/extensions/web3-core/QUICKSTART.md"
            target="_blank"
            >å¿«é€Ÿå¼€å§‹</a
          >
          | ğŸ—ï¸
          <a
            href="file:///Users/huangrenbin/Documents/UGit/openclaw/extensions/web3-core/ARCHITECTURE.md"
            target="_blank"
            >æ¶æ„æ–‡æ¡£</a
          >
          | ğŸ“š
          <a
            href="file:///Users/huangrenbin/Documents/UGit/openclaw/extensions/web3-core/README.md"
            target="_blank"
            >README</a
          >
        </p>
        <p style="margin-top: 10px; opacity: 0.8">OpenClaw Web3 Core Plugin v2026.2.16 Â© 2026</p>
      </div>
    </div>

    <script>
      // æ¨¡æ‹Ÿæ•°æ®
      let mockData = {
        walletAddress: null,
        auditEvents: [],
        creditsUsed: 0,
        creditsTotal: 1000,
        storageUploads: [],
        chainAnchors: [],
      };

      // ç”Ÿæˆéšæœºå“ˆå¸Œ
      function generateHash() {
        return (
          "0x" +
          Array.from({ length: 64 }, () => Math.floor(Math.random() * 16).toString(16)).join("")
        );
      }

      // æ ¼å¼åŒ–æ—¶é—´
      function formatTime() {
        return new Date().toLocaleTimeString("zh-CN");
      }

      // 1. èº«ä»½è®¤è¯åŠŸèƒ½
      function generateChallenge() {
        const address =
          document.getElementById("walletAddress").value ||
          "0x" +
            Array.from({ length: 40 }, () => Math.floor(Math.random() * 16).toString(16)).join("");
        const nonce = Math.random().toString(36).substring(7);
        const output = document.getElementById("identityOutput");

        output.style.display = "block";
        output.innerHTML = `ğŸ” SIWE æŒ‘æˆ˜å·²ç”Ÿæˆ

åŸŸå: app.openclaw.ai
åœ°å€: ${address}
éšæœºæ•°: ${nonce}
æ—¶é—´: ${new Date().toISOString()}

å®Œæ•´æ¶ˆæ¯:
app.openclaw.ai wants you to sign in with your Ethereum account:
${address}

Sign in to OpenClaw AI

URI: https://app.openclaw.ai
Version: 1
Chain ID: 1
Nonce: ${nonce}
Issued At: ${new Date().toISOString()}`;
      }

      function bindWallet() {
        const address = document.getElementById("walletAddress").value;
        if (!address) {
          alert("è¯·å…ˆè¾“å…¥é’±åŒ…åœ°å€");
          return;
        }

        mockData.walletAddress = address;
        const output = document.getElementById("identityOutput");
        output.style.display = "block";
        output.innerHTML = `âœ… é’±åŒ…ç»‘å®šæˆåŠŸ

åœ°å€: ${address}
æ—¶é—´: ${formatTime()}
çŠ¶æ€: å·²éªŒè¯

ç»‘å®šä¿¡æ¯å·²ä¿å­˜åˆ°:
~/.openclaw/web3/bindings.json`;
      }

      function checkIdentity() {
        const output = document.getElementById("identityOutput");
        output.style.display = "block";

        if (mockData.walletAddress) {
          output.innerHTML = `ğŸ‘¤ å½“å‰èº«ä»½ä¿¡æ¯

é’±åŒ…åœ°å€: ${mockData.walletAddress}
ç»‘å®šæ—¶é—´: ${formatTime()}
è®¤è¯æ–¹å¼: SIWE (EIP-4361)
çŠ¶æ€: âœ… å·²éªŒè¯

é“¾ä¸Šèº«ä»½:
- ENS: demo.eth
- NFT æŒæœ‰: 3 ä¸ª
- DeFi å‚ä¸: Uniswap, Aave`;
        } else {
          output.innerHTML = `âŒ æœªç»‘å®šé’±åŒ…

è¯·å…ˆä½¿ç”¨ "ç»‘å®šé’±åŒ…" åŠŸèƒ½è¿›è¡Œèº«ä»½è®¤è¯`;
        }
      }

      // 2. å®¡è®¡è¿½è¸ªåŠŸèƒ½
      function createAuditEvent() {
        const event = {
          id: "evt_" + Date.now(),
          type: "llm_input",
          timestamp: new Date().toISOString(),
          hash: generateHash(),
          status: "pending",
        };

        mockData.auditEvents.push(event);
        const output = document.getElementById("auditOutput");
        output.style.display = "block";
        output.innerHTML = `âœ… å®¡è®¡äº‹ä»¶å·²åˆ›å»º

äº‹ä»¶ ID: ${event.id}
ç±»å‹: LLM è¾“å…¥å®¡è®¡
æ—¶é—´: ${formatTime()}
å“ˆå¸Œ: ${event.hash.substring(0, 20)}...
çŠ¶æ€: å¾…ä¸Šä¼ 

å·²è®°å½•åˆ°æœ¬åœ°å®¡è®¡æ—¥å¿—`;

        updateAuditTimeline();
      }

      function queryAuditLog() {
        const output = document.getElementById("auditOutput");
        output.style.display = "block";

        if (mockData.auditEvents.length === 0) {
          output.innerHTML = "ğŸ“‹ å®¡è®¡æ—¥å¿—ä¸ºç©º\n\nè¯·å…ˆåˆ›å»ºå®¡è®¡äº‹ä»¶";
          return;
        }

        output.innerHTML = `ğŸ“‹ å®¡è®¡æ—¥å¿—æŸ¥è¯¢ç»“æœ

å…± ${mockData.auditEvents.length} æ¡äº‹ä»¶

${mockData.auditEvents
  .map(
    (e, i) => `
${i + 1}. äº‹ä»¶ ID: ${e.id}
   ç±»å‹: ${e.type}
   æ—¶é—´: ${new Date(e.timestamp).toLocaleTimeString()}
   å“ˆå¸Œ: ${e.hash.substring(0, 30)}...
   çŠ¶æ€: ${e.status}
`,
  )
  .join("\n")}`;

        updateAuditTimeline();
      }

      function verifyIntegrity() {
        const output = document.getElementById("auditOutput");
        output.style.display = "block";
        output.innerHTML = `ğŸ” æ•°æ®å®Œæ•´æ€§éªŒè¯

âœ… æœ¬åœ°æ—¥å¿—: å®Œæ•´ (${mockData.auditEvents.length} æ¡)
âœ… å“ˆå¸Œé“¾: æœ‰æ•ˆ
âœ… æ—¶é—´æˆ³: å•è°ƒé€’å¢
âœ… é“¾ä¸Šé”šå®š: ${mockData.chainAnchors.length} ä¸ªé”šç‚¹

éªŒè¯æ—¶é—´: ${formatTime()}
çŠ¶æ€: æ‰€æœ‰æ£€æŸ¥é€šè¿‡ âœ…`;
      }

      function updateAuditTimeline() {
        const timeline = document.getElementById("auditTimeline");
        timeline.style.display = "block";
        timeline.innerHTML = mockData.auditEvents
          .slice(-5)
          .reverse()
          .map(
            (e) => `
                <div class="timeline-item">
                    <div class="timeline-time">${new Date(e.timestamp).toLocaleTimeString()}</div>
                    <div class="timeline-event">${e.type} - ${e.id}</div>
                </div>
            `,
          )
          .join("");
      }

      // 3. è®¡è´¹ä¿æŠ¤åŠŸèƒ½
      function checkCredits() {
        const output = document.getElementById("billingOutput");
        output.style.display = "block";
        output.innerHTML = `ğŸ’° é…é¢çŠ¶æ€

å·²ä½¿ç”¨: ${mockData.creditsUsed} credits
å‰©ä½™: ${mockData.creditsTotal - mockData.creditsUsed} credits
æ€»é…é¢: ${mockData.creditsTotal} credits

ä½¿ç”¨ç‡: ${((mockData.creditsUsed / mockData.creditsTotal) * 100).toFixed(1)}%
çŠ¶æ€: ${mockData.creditsUsed < mockData.creditsTotal * 0.8 ? "âœ… å……è¶³" : "âš ï¸ æ¥è¿‘ä¸Šé™"}`;

        updateCreditsDisplay();
      }

      function simulateUsage() {
        const cost = Math.floor(Math.random() * 50) + 10;
        mockData.creditsUsed += cost;

        const output = document.getElementById("billingOutput");
        output.style.display = "block";
        output.innerHTML = `ğŸ“Š ä½¿ç”¨è®°å½•

æœ¬æ¬¡æ¶ˆè€—: ${cost} credits
ç´¯è®¡ä½¿ç”¨: ${mockData.creditsUsed} credits
å‰©ä½™é…é¢: ${mockData.creditsTotal - mockData.creditsUsed} credits

æ“ä½œç±»å‹: LLM ç”Ÿæˆ
token æ•°: ${cost * 100}
æ—¶é—´: ${formatTime()}`;

        updateCreditsDisplay();
      }

      function checkPaymentStatus() {
        const output = document.getElementById("billingOutput");
        output.style.display = "block";
        output.innerHTML = `ğŸ’³ æ”¯ä»˜çŠ¶æ€

é’±åŒ…åœ°å€: ${mockData.walletAddress || "æœªç»‘å®š"}
æ”¯ä»˜æ–¹å¼: é“¾ä¸Šä»£å¸
ä½™é¢çŠ¶æ€: âœ… å……è¶³

å†å²æ”¯ä»˜:
- 2026-02-15: +1000 credits (0.01 ETH)
- 2026-02-10: +500 credits (0.005 ETH)

ä¸‹æ¬¡è´¦å•: 2026-03-01`;
      }

      function updateCreditsDisplay() {
        document.getElementById("creditsUsed").textContent = mockData.creditsUsed;
        document.getElementById("creditsRemaining").textContent =
          mockData.creditsTotal - mockData.creditsUsed;
      }

      // 4. å»ä¸­å¿ƒåŒ–å­˜å‚¨åŠŸèƒ½
      function uploadToStorage() {
        const provider = document.getElementById("storageProvider").value;
        const cid =
          "Qm" +
          Array.from({ length: 44 }, () =>
            "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(
              Math.floor(Math.random() * 62),
            ),
          ).join("");

        const upload = {
          provider,
          cid,
          timestamp: new Date().toISOString(),
          size: Math.floor(Math.random() * 10000) + 1000,
        };

        mockData.storageUploads.push(upload);

        const output = document.getElementById("storageOutput");
        output.style.display = "block";
        output.innerHTML = `âœ… ä¸Šä¼ æˆåŠŸ

æä¾›å•†: ${provider.toUpperCase()}
CID: ${cid}
å¤§å°: ${(upload.size / 1024).toFixed(2)} KB
æ—¶é—´: ${formatTime()}

è®¿é—® URL:
${
  provider === "ipfs"
    ? `https://gateway.pinata.cloud/ipfs/${cid}`
    : provider === "arweave"
      ? `https://arweave.net/${cid}`
      : `https://filecoin.io/${cid}`
}`;
      }

      function retrieveFromStorage() {
        const output = document.getElementById("storageOutput");
        output.style.display = "block";

        if (mockData.storageUploads.length === 0) {
          output.innerHTML = "âŒ æ²¡æœ‰å·²ä¸Šä¼ çš„æ–‡ä»¶\n\nè¯·å…ˆä¸Šä¼ æ•°æ®";
          return;
        }

        const recent = mockData.storageUploads[mockData.storageUploads.length - 1];
        output.innerHTML = `ğŸ“¥ æ•°æ®æ£€ç´¢

CID: ${recent.cid}
æä¾›å•†: ${recent.provider.toUpperCase()}
å¤§å°: ${(recent.size / 1024).toFixed(2)} KB
çŠ¶æ€: âœ… å¯ç”¨

å†…å®¹é¢„è§ˆ:
{
  "session_id": "sess_demo_001",
  "messages": [...],
  "metadata": {
    "encrypted": true,
    "integrity_hash": "${generateHash().substring(0, 20)}..."
  }
}`;
      }

      function checkStorageStatus() {
        const output = document.getElementById("storageOutput");
        output.style.display = "block";
        output.innerHTML = `ğŸ“Š å­˜å‚¨çŠ¶æ€

æ€»ä¸Šä¼ æ•°: ${mockData.storageUploads.length}
æ€»å¤§å°: ${(mockData.storageUploads.reduce((sum, u) => sum + u.size, 0) / 1024).toFixed(2)} KB

æä¾›å•†åˆ†å¸ƒ:
- IPFS: ${mockData.storageUploads.filter((u) => u.provider === "ipfs").length}
- Arweave: ${mockData.storageUploads.filter((u) => u.provider === "arweave").length}
- Filecoin: ${mockData.storageUploads.filter((u) => u.provider === "filecoin").length}

æ‰€æœ‰ä¸Šä¼ å‡å·²åŠ å¯† ğŸ”’`;
      }

      // 5. é“¾ä¸Šé”šå®šåŠŸèƒ½
      function anchorData() {
        const chain = document.getElementById("targetChain").value;
        const txHash =
          "0x" +
          Array.from({ length: 64 }, () => Math.floor(Math.random() * 16).toString(16)).join("");

        const anchor = {
          chain,
          txHash,
          dataHash: generateHash(),
          timestamp: new Date().toISOString(),
          blockNumber: Math.floor(Math.random() * 1000000) + 10000000,
        };

        mockData.chainAnchors.push(anchor);

        const output = document.getElementById("chainOutput");
        output.style.display = "block";
        output.innerHTML = `âœ… é”šå®šæˆåŠŸ

ç›®æ ‡é“¾: ${chain.toUpperCase()}
äº¤æ˜“å“ˆå¸Œ: ${txHash}
åŒºå—é«˜åº¦: ${anchor.blockNumber}
æ•°æ®å“ˆå¸Œ: ${anchor.dataHash.substring(0, 30)}...
æ—¶é—´: ${formatTime()}

åŒºå—æµè§ˆå™¨:
${
  chain === "base"
    ? "https://basescan.org/tx/"
    : chain === "optimism"
      ? "https://optimistic.etherscan.io/tx/"
      : "https://arbiscan.io/tx/"
}${txHash}`;
      }

      function verifyAnchor() {
        const output = document.getElementById("chainOutput");
        output.style.display = "block";

        if (mockData.chainAnchors.length === 0) {
          output.innerHTML = "âŒ æ²¡æœ‰é”šå®šè®°å½•\n\nè¯·å…ˆé”šå®šæ•°æ®";
          return;
        }

        const recent = mockData.chainAnchors[mockData.chainAnchors.length - 1];
        output.innerHTML = `ğŸ” é”šå®šéªŒè¯

äº¤æ˜“å“ˆå¸Œ: ${recent.txHash}
é“¾: ${recent.chain.toUpperCase()}
åŒºå—: ${recent.blockNumber}
ç¡®è®¤æ•°: ${Math.floor(Math.random() * 100) + 10}

âœ… äº¤æ˜“å·²ç¡®è®¤
âœ… æ•°æ®å“ˆå¸ŒåŒ¹é…
âœ… æ—¶é—´æˆ³æœ‰æ•ˆ

éªŒè¯çŠ¶æ€: é€šè¿‡ âœ…`;
      }

      function getAnchorHistory() {
        const output = document.getElementById("chainOutput");
        output.style.display = "block";

        if (mockData.chainAnchors.length === 0) {
          output.innerHTML = "ğŸ“‹ æš‚æ— é”šå®šå†å²";
          return;
        }

        output.innerHTML = `ğŸ“‹ é”šå®šå†å²

å…± ${mockData.chainAnchors.length} æ¡è®°å½•

${mockData.chainAnchors
  .map(
    (a, i) => `
${i + 1}. é“¾: ${a.chain.toUpperCase()}
   äº¤æ˜“: ${a.txHash.substring(0, 20)}...
   åŒºå—: ${a.blockNumber}
   æ—¶é—´: ${new Date(a.timestamp).toLocaleTimeString()}
`,
  )
  .join("\n")}`;
      }

      // 6. æ•´ä½“çŠ¶æ€åŠŸèƒ½
      function getOverallStatus() {
        const output = document.getElementById("statusOutput");
        output.style.display = "block";
        output.innerHTML = `ğŸ“Š Web3 Core æ•´ä½“çŠ¶æ€

æ’ä»¶ç‰ˆæœ¬: v2026.2.16
çŠ¶æ€: âœ… Loaded

ğŸ” èº«ä»½æ¨¡å—
  é’±åŒ…ç»‘å®š: ${mockData.walletAddress ? "âœ… " + mockData.walletAddress : "âŒ æœªç»‘å®š"}
  è®¤è¯æ–¹å¼: SIWE (EIP-4361)

ğŸ“ å®¡è®¡æ¨¡å—
  äº‹ä»¶æ•°: ${mockData.auditEvents.length}
  æœ€è¿‘äº‹ä»¶: ${mockData.auditEvents.length > 0 ? formatTime() : "æ— "}

ğŸ’° è®¡è´¹æ¨¡å—
  å·²ä½¿ç”¨: ${mockData.creditsUsed}/${mockData.creditsTotal} credits
  ä½¿ç”¨ç‡: ${((mockData.creditsUsed / mockData.creditsTotal) * 100).toFixed(1)}%

ğŸ’¾ å­˜å‚¨æ¨¡å—
  ä¸Šä¼ æ•°: ${mockData.storageUploads.length}
  æ€»å¤§å°: ${(mockData.storageUploads.reduce((sum, u) => sum + u.size, 0) / 1024).toFixed(2)} KB

â›“ï¸ é”šå®šæ¨¡å—
  é”šå®šæ•°: ${mockData.chainAnchors.length}
  æœ€è¿‘é“¾: ${mockData.chainAnchors.length > 0 ? mockData.chainAnchors[mockData.chainAnchors.length - 1].chain : "æ— "}

æ›´æ–°æ—¶é—´: ${formatTime()}`;
      }

      function runHealthCheck() {
        const output = document.getElementById("statusOutput");
        output.style.display = "block";
        output.classList.add("loading");

        setTimeout(() => {
          output.classList.remove("loading");
          output.innerHTML = `ğŸ¥ å¥åº·æ£€æŸ¥æŠ¥å‘Š

âœ… æ’ä»¶åŠ è½½: æ­£å¸¸
âœ… é…ç½®æ–‡ä»¶: æœ‰æ•ˆ
âœ… å­˜å‚¨è¿æ¥: æ­£å¸¸
âœ… RPC èŠ‚ç‚¹: æ­£å¸¸
âœ… æœ¬åœ°æ•°æ®åº“: æ­£å¸¸
âœ… åå°æœåŠ¡: è¿è¡Œä¸­

æ‰€æœ‰ç³»ç»Ÿæ­£å¸¸ âœ…

æ£€æŸ¥æ—¶é—´: ${formatTime()}`;
        }, 1500);
      }

      function resetDemo() {
        if (confirm("ç¡®å®šè¦é‡ç½®æ¼”ç¤ºæ•°æ®å—ï¼Ÿ")) {
          mockData = {
            walletAddress: null,
            auditEvents: [],
            creditsUsed: 0,
            creditsTotal: 1000,
            storageUploads: [],
            chainAnchors: [],
          };

          updateCreditsDisplay();

          // æ¸…ç©ºæ‰€æœ‰è¾“å‡º
          [
            "identityOutput",
            "auditOutput",
            "billingOutput",
            "storageOutput",
            "chainOutput",
            "statusOutput",
          ].forEach((id) => {
            const el = document.getElementById(id);
            if (el) el.style.display = "none";
          });

          document.getElementById("auditTimeline").style.display = "none";
          document.getElementById("walletAddress").value = "";

          alert("âœ… æ¼”ç¤ºæ•°æ®å·²é‡ç½®");
        }
      }

      // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
      window.onload = function () {
        console.log("Web3 Core Plugin Demo Loaded");
        // ç”Ÿæˆä¸€ä¸ªç¤ºä¾‹é’±åŒ…åœ°å€
        document.getElementById("walletAddress").value =
          "0x" +
          Array.from({ length: 40 }, () => Math.floor(Math.random() * 16).toString(16)).join("");
      };
    </script>
  </body>
</html>
